name: Deploy Django app to Azure

on:
  pull_request:
    branches: [ 'main']
  
jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout Code
              uses: actions/checkout@v2
            - name: Login to Azure
              uses: azure/login@v1
              with:
                creds: ${{secrets.AZURE_CREDS}}
            - name: Build docker images
              run: |
                docker build -f .\BasketSaverCatalogService\Dockerfile.backend .\BasketSaverCatalogService\. -t basketsaverregistry.azurecr.io/basketsavercatalogservice:latest
                docker push basketsaverregistry.azurecr.io/basketsavercatalogservice:latest